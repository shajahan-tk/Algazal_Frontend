import{aa as A,ab as P,ad as k,r as n,j as e,v as w,m as g,ae as L}from"./index-CfFwh--H.js";import{a as T}from"./SalesService-CNpZcSS1.js";import{A as E}from"./AdaptableCard-T1jSCi4m.js";import{A as R}from"./index-CSFznbuf.js";import{D as F}from"./DataTable-B06t5ZtT.js";import{O as K,W as I,Z as _,_ as $}from"./index-CEOENyZN.js";import{F as z}from"./index-h6pWLCgn.js";import{u as H}from"./useThemeClass-Rhgp5cBq.js";import{u as M}from"./useQuery-B-q1oy2W.js";import{d as q}from"./debounce-C6Vtcf0t.js";import{I as O}from"./Input-CT3ndZ0a.js";import{f as B}from"./api-CucygYma.js";import{B as h}from"./Button-DK8YG6Vd.js";import"./Card-DrR7Wowt.js";import"./floating-ui.react-DGPs_AnH.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-CbqZmROt.js";import"./proxy-DVFC3BrG.js";import"./index-uPavB4wA.js";import"./index-LGebAmfn.js";import"./Skeleton-CkbmhpF1.js";import"./Views-DDo_d-60.js";import"./_getPrototype-QbS_EcaU.js";import"./Select-DXgitA5g.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-ByyYtpKF.js";import"./context-ClB8cHxu.js";import"./index-WfMoUKkC.js";import"./toString-tgkm5ft3.js";const f="salesProductList",x=A(f+"/getProducts",async t=>(await T(t)).data),G={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Q={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:G,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},b=P({name:`${f}/state`,initialState:Q,reducers:{updateProductList:(t,a)=>{t.productList=a.payload},setTableData:(t,a)=>{t.tableData=a.payload},setFilterData:(t,a)=>{t.filterData=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setSelectedProduct:(t,a)=>{t.selectedProduct=a.payload}},extraReducers:t=>{t.addCase(x.fulfilled,(a,r)=>{a.productList=r.payload.data,a.tableData.total=r.payload.total,a.loading=!1}).addCase(x.pending,a=>{a.loading=!0})}}),{updateProductList:we,setTableData:Le,setFilterData:Te,toggleDeleteConfirmation:Ee,setSelectedProduct:Re}=b.actions,U=b.reducer,V=k({data:U}),W=({row:t})=>{const{textTheme:a}=H(),r=w(),i=()=>{r(`/app/client-form/${t._id}`)},l=()=>{r(`/app/client-view/${t==null?void 0:t._id}`)};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:l,children:e.jsx(K,{})}),e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:i,children:e.jsx(I,{})})]})},Z=({row:t})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{icon:e.jsx(z,{})}),e.jsx("span",{className:"ml-2 rtl:mr-2 font-semibold",children:t.clientName})]}),J=()=>{var p,u;const t=n.useRef(null),[a,r]=n.useState(""),[i,l]=n.useState({page:1,limit:10}),{data:o,isLoading:j,error:m}=M({queryKey:["clients",i.page,i.limit,a],queryFn:()=>B({page:i.page,limit:i.limit,search:a})}),C=((p=o==null?void 0:o.data)==null?void 0:p.clients)||[],d=((u=o==null?void 0:o.data)==null?void 0:u.pagination)||{total:0,page:1,limit:10},y=n.useMemo(()=>q(s=>{r(s),l(c=>({...c,page:1}))},500),[]),N=s=>{y(s.target.value)},v=n.useMemo(()=>[{header:"Client Name",accessorKey:"clientName",cell:s=>e.jsx(Z,{row:s.row.original})},{header:"Address",accessorKey:"clientAddress",cell:s=>e.jsx("span",{children:s.row.original.clientAddress})},{header:"Mobile",accessorKey:"mobileNumber",cell:s=>e.jsx("span",{children:s.row.original.mobileNumber})},{header:"TRN",accessorKey:"trnNumber",cell:s=>e.jsx("span",{children:s.row.original.trnNumber})},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Action",id:"action",cell:s=>e.jsx(W,{row:s.row.original})}],[]),D=s=>{l(c=>({...c,page:s}))},S=s=>{l(c=>({page:1,limit:s}))};return m?e.jsxs("div",{children:["Error loading clients: ",m.message]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(O,{placeholder:"Search clients...",onChange:N,className:"max-w-md"})}),e.jsx(F,{ref:t,columns:v,data:C,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:j,pagingData:{total:d.total,pageIndex:d.page,pageSize:d.limit},onPaginationChange:D,onSelectChange:S})]})},X=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(g,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/client-list.csv",target:"_blank",children:e.jsx(h,{block:!0,size:"sm",icon:e.jsx(_,{}),children:"Export"})}),e.jsx(g,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/client-new",children:e.jsx(h,{block:!0,variant:"solid",size:"sm",icon:e.jsx($,{}),children:"Add Client"})})]});L("salesClientList",V);const Fe=()=>e.jsxs(E,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Clients"}),e.jsx(X,{})]}),e.jsx(J,{})]});export{Fe as default};
