import{ab as A,aa as T,ac as k,ad as E,a as I,j as a,r as m,v as K}from"./index-CfFwh--H.js";import{B as R}from"./Badge-Bo_BJ3HY.js";import{D as $}from"./DataTable-B06t5ZtT.js";import{O as z,W as O}from"./index-CEOENyZN.js";import{u as q}from"./useThemeClass-Rhgp5cBq.js";import{t as F,N as B}from"./toast-CZz_7xZu.js";import{C as M}from"./ConfirmDialog-Bh7fmtF9.js";import{b as _,a as H}from"./SalesService-CNpZcSS1.js";import{u as G}from"./useQuery-B-q1oy2W.js";import{d as Q}from"./debounce-C6Vtcf0t.js";import{I as V}from"./Input-CT3ndZ0a.js";import{b as W}from"./api-BcIGmN9v.js";import"./index-uPavB4wA.js";import"./index-LGebAmfn.js";import"./Skeleton-CkbmhpF1.js";import"./Views-DDo_d-60.js";import"./_getPrototype-QbS_EcaU.js";import"./Select-DXgitA5g.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-ByyYtpKF.js";import"./floating-ui.dom-B_iSk-nO.js";import"./context-ClB8cHxu.js";import"./index-WfMoUKkC.js";import"./StatusIcon-CVY_iJbr.js";import"./CloseButton-BXsrAn2U.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-DVFC3BrG.js";import"./index-CSFznbuf.js";import"./floating-ui.react-DGPs_AnH.js";import"./index-CbqZmROt.js";import"./Button-DK8YG6Vd.js";import"./Dialog-CCGqt-e6.js";import"./index-C6dvUS2c.js";import"./toString-tgkm5ft3.js";const P="salesProductList",g=T(P+"/getProducts",async e=>(await H(e)).data),J=async e=>(await _(e)).data,U={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},X={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:U,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},D=A({name:`${P}/state`,initialState:X,reducers:{updateProductList:(e,t)=>{e.productList=t.payload},setTableData:(e,t)=>{e.tableData=t.payload},setFilterData:(e,t)=>{e.filterData=t.payload},toggleDeleteConfirmation:(e,t)=>{e.deleteConfirmation=t.payload},setSelectedProduct:(e,t)=>{e.selectedProduct=t.payload}},extraReducers:e=>{e.addCase(g.fulfilled,(t,c)=>{t.productList=c.payload.data,t.tableData.total=c.payload.total,t.loading=!1}).addCase(g.pending,t=>{t.loading=!0})}}),{updateProductList:$e,setTableData:ze,setFilterData:Oe,toggleDeleteConfirmation:b,setSelectedProduct:qe}=D.actions,Y=D.reducer;E({data:Y});const u=k,Z=()=>{const e=I(),t=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.deleteConfirmation}),c=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.selectedProduct}),i=u(p=>{var r,n;return(n=(r=p.salesProductList)==null?void 0:r.data)==null?void 0:n.tableData}),l=()=>{e(b(!1))},d=async()=>{e(b(!1)),await J({id:c})&&(e(g(i)),F.push(a.jsx(B,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Product successfuly deleted"}),{placement:"top-center"}))};return a.jsx(M,{isOpen:t,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:d,children:a.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})},y={active:{label:"Active",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},inactive:{label:"Inactive",dotClass:"bg-green-500",textClass:"text-green-500"},completed:{label:"Completed",dotClass:"bg-blue-500",textClass:"text-blue-500"}},ee=({row:e})=>{const{textTheme:t}=q(),c=K(),i=()=>{c(`/app/project-edit/${e._id}`)},l=()=>{c(`/app/project-view/${e==null?void 0:e._id}`)};return a.jsxs("div",{className:"flex justify-start text-lg",children:[a.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:l,children:a.jsx(z,{})}),a.jsx("span",{className:`cursor-pointer p-2 hover:${t}`,onClick:i,children:a.jsx(O,{})})]})},Fe=()=>{var h,f;const e=m.useRef(null),[t,c]=m.useState(""),[i,l]=m.useState({page:1,limit:10}),{data:d,isLoading:p,error:r,refetch:n}=G({queryKey:["projects",i.page,i.limit,t],queryFn:()=>W({page:i.page,limit:i.limit,search:t}),keepPreviousData:!0}),N=m.useMemo(()=>Q(s=>{c(s),l(o=>({...o,page:1}))},500),[]),S=s=>{N(s.target.value)},v=m.useMemo(()=>[{header:"Project Name",accessorKey:"projectName",cell:s=>{var o;return a.jsx("span",{children:(o=s.row.original)==null?void 0:o.projectName})}},{header:"Client Name",accessorKey:"clientName",cell:s=>{var o;return a.jsx("span",{children:(o=s.row.original)==null?void 0:o.client.clientName})}},{header:"Progress",accessorKey:"progress",cell:s=>{var o;return a.jsx("span",{className:"capitalize",children:(o=s.row.original)==null?void 0:o.progress})}},{header:"Project Number",accessorKey:"progress",cell:s=>{var o;return a.jsx("span",{className:"capitalize",children:(o=s.row.original)==null?void 0:o.projectNumber})}},{header:"Status",accessorKey:"status",cell:s=>{var x,C;const o=((x=s.row.original.status)==null?void 0:x.toLowerCase())||"inactive",j=y[o]||y.inactive;return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(R,{className:j.dotClass}),a.jsx("span",{className:`capitalize font-semibold ${j.textClass}`,children:(C=s.row.original)==null?void 0:C.status})]})}},{header:"Action",id:"action",cell:s=>a.jsx(ee,{row:s.row.original})}],[]),w=s=>{l(o=>({...o,page:s}))},L=s=>{l(o=>({page:1,limit:s}))};return r?a.jsxs("div",{children:["Error loading projects: ",r.message]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4",children:a.jsx(V,{placeholder:"Search projects...",onChange:S,className:"max-w-md"})}),a.jsx($,{ref:e,columns:v,data:((h=d==null?void 0:d.data)==null?void 0:h.projects)||[],skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:p,pagingData:{total:((f=d==null?void 0:d.data)==null?void 0:f.total)||0,pageIndex:i.page,pageSize:i.limit},onPaginationChange:w,onSelectChange:L}),a.jsx(Z,{})]})};export{Fe as default};
