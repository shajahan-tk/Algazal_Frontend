import{r as v,j as e,v as oe,ak as me}from"./index-DrziBPhZ.js";import{N as E,t as S}from"./toast-ClnWKBBo.js";import{F as de,a as m}from"./FormItem-Cku4jOg1.js";import{B as M}from"./Button-DG2-jqZG.js";import{S as ue}from"./StickyFooter-RWxGWKXo.js";import{F as pe,a as ce,b as d}from"./formik.esm-CPLrydYm.js";import{A as be}from"./index-CBDs7g4_.js";import{$ as he}from"./index-Ds8t50Me.js";import{c as ye,g as p,f as D,b as k}from"./index.esm-BB-UMuCJ.js";import"./Alert-BLGo7HyM.js";import"./index-yw21U4bP.js";import"./Badge-C2KmHilm.js";import{D as L}from"./index-BmalSfvl.js";import"./Card-nlnRLrlQ.js";import"./Skeleton-C2woZuKJ.js";import"./Dialog-D7FxUuyk.js";import"./Drawer-IABuvwPK.js";import"./index-8tDMqpHX.js";import"./useUniqueId-B25XPIVz.js";import{I as u}from"./Input-B4wHBRkW.js";import"./index-DKNJHN__.js";import"./index-ChB5CpHQ.js";import"./index-DN1w59Ps.js";import"./index-Cv7sYzj3.js";import"./ScrollBar-CAweRmRR.js";import{S as xe}from"./Select-nm3Sb7o5.js";import"./Upload-DVKHQbcn.js";import"./index-BPwFYay9.js";import"./Tag-C5UAaR6R.js";import{A}from"./AdaptableCard-DmZKEZU8.js";import"./Views-D-uBkVS-.js";import"./chart.config-DDCNvm2Q.js";import"./DataTable-aN3aFI0i.js";import"./SvgIcon-BvWLwctQ.js";import"./SegmentItemOption-Cj0dKbLO.js";import{n as ge,N as je,O as ve,P as Pe}from"./api-BL3Ea9lB.js";import"./StatusIcon-vuYtWMPB.js";import"./CloseButton-CSyekQus.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-MIyuRDz8.js";import"./context-B0dog8SG.js";import"./index-3lctU3d7.js";import"./cloneDeep-DJN0yfLA.js";import"./hoist-non-react-statics.cjs-u5YpxD3p.js";import"./floating-ui.react-K4q-Qtxj.js";import"./floating-ui.dom-B_iSk-nO.js";import"./useControllableState-0JrmfMFZ.js";import"./_getPrototype-Dk_uG1mG.js";import"./index-CBr4D0uW.js";import"./toString-9EwY3KIP.js";import"./index-Csg7nRTo.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-KN0VPQ3v.js";import"./index-GlPtBqgB.js";import"./useThemeClass-DpghVrlu.js";const q=v.forwardRef((x,b)=>{const{type:I,initialData:s={employee:"",iBan:"",passportNumber:"",passportExpireDate:"",emirateIdNumber:"",emirateIdExpireDate:"",labourCardPersonalNumber:"",workPermitNumber:"",labourExpireDate:"",offerLetterTyping:"0",labourInsurance:"0",labourCardPayment:"0",statusChangeInOut:"0",insideEntry:"0",medicalSharjah:"0",tajweehSubmission:"0",iloeInsurance:"0",healthInsurance:"0",emirateId:"0",residenceStamping:"0",srilankaCouncilHead:"0",upscoding:"0",labourFinePayment:"0",labourCardRenewalPayment:"0",servicePayment:"0",visaStamping:"0",twoMonthVisitingVisa:"0",finePayment:"0",entryPermitOutside:"0",complaintEmployee:"0",arabicLetter:"0",violationCommittee:"0",quotaModification:"0",others:"0"},onFormSubmit:N,onDiscard:g,onDelete:P}=x,[C,f]=v.useState([]);v.useEffect(()=>{(async()=>{var r;try{const h=(r=(await ge()).data)==null?void 0:r.users.map(t=>({value:t._id,label:`${t.firstName} ${t.lastName}`,passportNumber:t.passportNumber,emirateIdNumber:t.emiratesId}));f(h)}catch(a){console.error("Failed to fetch users",a)}})()},[]);const w=ye().shape({employee:k().required("Employee is required"),passportNumber:k().required("Passport number is required"),emirateIdNumber:k().required("Emirate ID number is required"),passportExpireDate:D().required("Passport expiry date is required"),emirateIdExpireDate:D().required("Emirate ID expiry date is required"),labourExpireDate:D().required("Labour card expiry date is required"),offerLetterTyping:p().min(0),labourInsurance:p().min(0),labourCardPayment:p().min(0),statusChangeInOut:p().min(0),insideEntry:p().min(0),medicalSharjah:p().min(0),tajweehSubmission:p().min(0),iloeInsurance:p().min(0),healthInsurance:p().min(0),emirateId:p().min(0),residenceStamping:p().min(0),srilankaCouncilHead:p().min(0),upscoding:p().min(0),labourFinePayment:p().min(0),labourCardRenewalPayment:p().min(0),servicePayment:p().min(0),visaStamping:p().min(0),twoMonthVisitingVisa:p().min(0),finePayment:p().min(0),entryPermitOutside:p().min(0),complaintEmployee:p().min(0),arabicLetter:p().min(0),violationCommittee:p().min(0),quotaModification:p().min(0),others:p().min(0)}),l=c=>["offerLetterTyping","labourInsurance","labourCardPayment","statusChangeInOut","insideEntry","medicalSharjah","tajweehSubmission","iloeInsurance","healthInsurance","emirateId","residenceStamping","srilankaCouncilHead","upscoding","labourFinePayment","labourCardRenewalPayment","servicePayment","visaStamping","twoMonthVisitingVisa","finePayment","entryPermitOutside","complaintEmployee","arabicLetter","violationCommittee","quotaModification","others"].reduce((a,h)=>{const t=parseFloat(c[h])||0;return a+t},0),o=(c,r,a)=>{a(c,r)};return e.jsx(pe,{innerRef:b,initialValues:{employee:s.employee||"",iBan:s.iBan||"",passportNumber:s.passportNumber||"",passportExpireDate:s.passportExpireDate instanceof Date?s.passportExpireDate:s.passportExpireDate?new Date(s.passportExpireDate):null,emirateIdNumber:s.emirateIdNumber||"",emirateIdExpireDate:s.emirateIdExpireDate instanceof Date?s.emirateIdExpireDate:s.emirateIdExpireDate?new Date(s.emirateIdExpireDate):null,labourCardPersonalNumber:s.labourCardPersonalNumber||"",workPermitNumber:s.workPermitNumber||"",labourExpireDate:s.labourExpireDate instanceof Date?s.labourExpireDate:s.labourExpireDate?new Date(s.labourExpireDate):null,offerLetterTyping:s.offerLetterTyping||"0",labourInsurance:s.labourInsurance||"0",labourCardPayment:s.labourCardPayment||"0",statusChangeInOut:s.statusChangeInOut||"0",insideEntry:s.insideEntry||"0",medicalSharjah:s.medicalSharjah||"0",tajweehSubmission:s.tajweehSubmission||"0",iloeInsurance:s.iloeInsurance||"0",healthInsurance:s.healthInsurance||"0",emirateId:s.emirateId||"0",residenceStamping:s.residenceStamping||"0",srilankaCouncilHead:s.srilankaCouncilHead||"0",upscoding:s.upscoding||"0",labourFinePayment:s.labourFinePayment||"0",labourCardRenewalPayment:s.labourCardRenewalPayment||"0",servicePayment:s.servicePayment||"0",visaStamping:s.visaStamping||"0",twoMonthVisitingVisa:s.twoMonthVisitingVisa||"0",finePayment:s.finePayment||"0",entryPermitOutside:s.entryPermitOutside||"0",complaintEmployee:s.complaintEmployee||"0",arabicLetter:s.arabicLetter||"0",violationCommittee:s.violationCommittee||"0",quotaModification:s.quotaModification||"0",others:s.others||"0"},validationSchema:w,onSubmit:async(c,{setSubmitting:r})=>{try{await N(c,r)}catch(a){r(!1),console.error("Form submission error:",a)}},enableReinitialize:!0,children:({values:c,touched:r,errors:a,isSubmitting:h,setFieldValue:t})=>{const y=l(c);return e.jsx(ce,{children:e.jsxs(de,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs(A,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Employee Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(m,{label:"Employee",invalid:!!a.employee&&r.employee,errorMessage:a.employee,children:e.jsx(xe,{options:C,value:C.filter(i=>i.value===c.employee),onChange:i=>{t("employee",i==null?void 0:i.value),i&&(t("passportNumber",i.passportNumber||""),t("emirateIdNumber",i.emirateIdNumber||""))}})}),e.jsx(m,{label:"IBAN",invalid:!!a.iBan&&r.iBan,errorMessage:a.iBan,children:e.jsx(d,{name:"iBan",children:({field:i})=>e.jsx(u,{placeholder:"IBAN",...i})})}),e.jsx(m,{label:"Passport Number",invalid:!!a.passportNumber&&r.passportNumber,errorMessage:a.passportNumber,children:e.jsx(d,{name:"passportNumber",children:({field:i})=>e.jsx(u,{placeholder:"Passport Number",...i})})}),e.jsx(m,{label:"Passport Expiry Date",invalid:!!a.passportExpireDate&&r.passportExpireDate,errorMessage:a.passportExpireDate,children:e.jsx(d,{name:"passportExpireDate",children:({field:i,form:n})=>e.jsx(L,{placeholder:"Select Passport Expiry Date",value:i.value?new Date(i.value):null,onChange:j=>n.setFieldValue(i.name,j)})})}),e.jsx(m,{label:"Emirate ID Number",invalid:!!a.emirateIdNumber&&r.emirateIdNumber,errorMessage:a.emirateIdNumber,children:e.jsx(d,{name:"emirateIdNumber",children:({field:i})=>e.jsx(u,{placeholder:"Emirate ID Number",...i})})}),e.jsx(m,{label:"Emirate ID Expiry Date",invalid:!!a.emirateIdExpireDate&&r.emirateIdExpireDate,errorMessage:a.emirateIdExpireDate,children:e.jsx(d,{name:"emirateIdExpireDate",children:({field:i,form:n})=>e.jsx(L,{placeholder:"Select Emirate ID Expiry Date",value:i.value?new Date(i.value):null,onChange:j=>n.setFieldValue(i.name,j)})})}),e.jsx(m,{label:"Labour Card Personal Number",invalid:!!a.labourCardPersonalNumber&&r.labourCardPersonalNumber,errorMessage:a.labourCardPersonalNumber,children:e.jsx(d,{name:"labourCardPersonalNumber",children:({field:i})=>e.jsx(u,{placeholder:"Labour Card Personal Number",...i})})}),e.jsx(m,{label:"Work Permit Number",invalid:!!a.workPermitNumber&&r.workPermitNumber,errorMessage:a.workPermitNumber,children:e.jsx(d,{name:"workPermitNumber",children:({field:i})=>e.jsx(u,{placeholder:"Work Permit Number",...i})})}),e.jsx(m,{label:"Labour Card Expiry Date",invalid:!!a.labourExpireDate&&r.labourExpireDate,errorMessage:a.labourExpireDate,children:e.jsx(d,{name:"labourExpireDate",children:({field:i,form:n})=>e.jsx(L,{placeholder:"Select Labour Card Expiry Date",value:i.value?new Date(i.value):null,onChange:j=>n.setFieldValue(i.name,j)})})})]})]}),e.jsxs(A,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Visa Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(m,{label:"Offer Letter Typing",invalid:!!a.offerLetterTyping&&r.offerLetterTyping,errorMessage:a.offerLetterTyping,children:e.jsx(d,{name:"offerLetterTyping",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("offerLetterTyping",n.target.value,t)})})}),e.jsx(m,{label:"Labour Insurance",invalid:!!a.labourInsurance&&r.labourInsurance,errorMessage:a.labourInsurance,children:e.jsx(d,{name:"labourInsurance",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("labourInsurance",n.target.value,t)})})}),e.jsx(m,{label:"Labour Card Payment",invalid:!!a.labourCardPayment&&r.labourCardPayment,errorMessage:a.labourCardPayment,children:e.jsx(d,{name:"labourCardPayment",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("labourCardPayment",n.target.value,t)})})}),e.jsx(m,{label:"Status Change In/Out",invalid:!!a.statusChangeInOut&&r.statusChangeInOut,errorMessage:a.statusChangeInOut,children:e.jsx(d,{name:"statusChangeInOut",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("statusChangeInOut",n.target.value,t)})})}),e.jsx(m,{label:"Inside Entry",invalid:!!a.insideEntry&&r.insideEntry,errorMessage:a.insideEntry,children:e.jsx(d,{name:"insideEntry",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("insideEntry",n.target.value,t)})})}),e.jsx(m,{label:"Medical Sharjah",invalid:!!a.medicalSharjah&&r.medicalSharjah,errorMessage:a.medicalSharjah,children:e.jsx(d,{name:"medicalSharjah",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("medicalSharjah",n.target.value,t)})})}),e.jsx(m,{label:"Tajweeh Submission",invalid:!!a.tajweehSubmission&&r.tajweehSubmission,errorMessage:a.tajweehSubmission,children:e.jsx(d,{name:"tajweehSubmission",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("tajweehSubmission",n.target.value,t)})})}),e.jsx(m,{label:"ILOE Insurance",invalid:!!a.iloeInsurance&&r.iloeInsurance,errorMessage:a.iloeInsurance,children:e.jsx(d,{name:"iloeInsurance",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("iloeInsurance",n.target.value,t)})})}),e.jsx(m,{label:"Health Insurance",invalid:!!a.healthInsurance&&r.healthInsurance,errorMessage:a.healthInsurance,children:e.jsx(d,{name:"healthInsurance",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("healthInsurance",n.target.value,t)})})}),e.jsx(m,{label:"Emirate ID Fee",invalid:!!a.emirateId&&r.emirateId,errorMessage:a.emirateId,children:e.jsx(d,{name:"emirateId",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("emirateId",n.target.value,t)})})}),e.jsx(m,{label:"Residence Stamping",invalid:!!a.residenceStamping&&r.residenceStamping,errorMessage:a.residenceStamping,children:e.jsx(d,{name:"residenceStamping",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("residenceStamping",n.target.value,t)})})}),e.jsx(m,{label:"Srilanka Council Head",invalid:!!a.srilankaCouncilHead&&r.srilankaCouncilHead,errorMessage:a.srilankaCouncilHead,children:e.jsx(d,{name:"srilankaCouncilHead",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("srilankaCouncilHead",n.target.value,t)})})}),e.jsx(m,{label:"Upscoding",invalid:!!a.upscoding&&r.upscoding,errorMessage:a.upscoding,children:e.jsx(d,{name:"upscoding",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("upscoding",n.target.value,t)})})}),e.jsx(m,{label:"Labour Fine Payment",invalid:!!a.labourFinePayment&&r.labourFinePayment,errorMessage:a.labourFinePayment,children:e.jsx(d,{name:"labourFinePayment",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("labourFinePayment",n.target.value,t)})})}),e.jsx(m,{label:"Labour Card Renewal Payment",invalid:!!a.labourCardRenewalPayment&&r.labourCardRenewalPayment,errorMessage:a.labourCardRenewalPayment,children:e.jsx(d,{name:"labourCardRenewalPayment",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("labourCardRenewalPayment",n.target.value,t)})})}),e.jsx(m,{label:"Service Payment",invalid:!!a.servicePayment&&r.servicePayment,errorMessage:a.servicePayment,children:e.jsx(d,{name:"servicePayment",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("servicePayment",n.target.value,t)})})}),e.jsx(m,{label:"Visa Stamping",invalid:!!a.visaStamping&&r.visaStamping,errorMessage:a.visaStamping,children:e.jsx(d,{name:"visaStamping",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("visaStamping",n.target.value,t)})})}),e.jsx(m,{label:"Two Month Visiting Visa",invalid:!!a.twoMonthVisitingVisa&&r.twoMonthVisitingVisa,errorMessage:a.twoMonthVisitingVisa,children:e.jsx(d,{name:"twoMonthVisitingVisa",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("twoMonthVisitingVisa",n.target.value,t)})})}),e.jsx(m,{label:"Fine Payment",invalid:!!a.finePayment&&r.finePayment,errorMessage:a.finePayment,children:e.jsx(d,{name:"finePayment",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("finePayment",n.target.value,t)})})}),e.jsx(m,{label:"Entry Permit Outside",invalid:!!a.entryPermitOutside&&r.entryPermitOutside,errorMessage:a.entryPermitOutside,children:e.jsx(d,{name:"entryPermitOutside",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("entryPermitOutside",n.target.value,t)})})}),e.jsx(m,{label:"Complaint Employee",invalid:!!a.complaintEmployee&&r.complaintEmployee,errorMessage:a.complaintEmployee,children:e.jsx(d,{name:"complaintEmployee",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("complaintEmployee",n.target.value,t)})})}),e.jsx(m,{label:"Arabic Letter",invalid:!!a.arabicLetter&&r.arabicLetter,errorMessage:a.arabicLetter,children:e.jsx(d,{name:"arabicLetter",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("arabicLetter",n.target.value,t)})})}),e.jsx(m,{label:"Violation Committee",invalid:!!a.violationCommittee&&r.violationCommittee,errorMessage:a.violationCommittee,children:e.jsx(d,{name:"violationCommittee",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("violationCommittee",n.target.value,t)})})}),e.jsx(m,{label:"Quota Modification",invalid:!!a.quotaModification&&r.quotaModification,errorMessage:a.quotaModification,children:e.jsx(d,{name:"quotaModification",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("quotaModification",n.target.value,t)})})}),e.jsx(m,{label:"Others",invalid:!!a.others&&r.others,errorMessage:a.others,children:e.jsx(d,{name:"others",children:({field:i})=>e.jsx(u,{type:"number",placeholder:"Amount",...i,onChange:n=>o("others",n.target.value,t)})})})]})]})]})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("div",{className:"bg-blue-50 dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-blue-100 dark:border-gray-600 w-64",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-600 dark:text-blue-300 mb-1",children:"Total Expenses"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200",children:y.toFixed(2)})]})}),e.jsxs(ue,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:I==="edit"&&P&&e.jsx(M,{size:"sm",variant:"plain",color:"red",icon:e.jsx(he,{}),type:"button",onClick:()=>P(()=>{}),children:"Delete"})}),e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(M,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>g==null?void 0:g(),children:"Discard"}),e.jsx(M,{size:"sm",variant:"solid",loading:h,icon:e.jsx(be,{}),type:"submit",children:"Save"})]})]})]})})}})});q.displayName="VisaExpenseForm";const O={employee:"",iBan:"",passportNumber:"",passportExpireDate:"",emirateIdNumber:"",emirateIdExpireDate:"",labourCardPersonalNumber:"",workPermitNumber:"",labourExpireDate:"",offerLetterTyping:"",labourInsurance:"",labourCardPayment:"",statusChangeInOut:"",insideEntry:"",medicalSharjah:"",tajweehSubmission:"",iloeInsurance:"",healthInsurance:"",emirateId:"",residenceStamping:"",srilankaCouncilHead:"",upscoding:"",labourFinePayment:"",labourCardRenewalPayment:"",servicePayment:"",visaStamping:"",twoMonthVisitingVisa:"",finePayment:"",entryPermitOutside:"",complaintEmployee:"",arabicLetter:"",violationCommittee:"",quotaModification:"",others:"",total:""},Ea=()=>{const x=oe(),{id:b}=me(),[I,s]=v.useState(O),[N,g]=v.useState(!!b),[P,C]=v.useState(null);v.useEffect(()=>{if(!b){s(O),g(!1);return}(async()=>{try{g(!0);const o=await je(b);if(!(o!=null&&o.data))throw new Error("Invalid visa expense data received");const{employee:c,iBan:r,passportNumber:a,passportExpireDate:h,emirateIdNumber:t,emirateIdExpireDate:y,labourCardPersonalNumber:i,workPermitNumber:n,labourExpireDate:j,offerLetterTyping:R,labourInsurance:T,labourCardPayment:V,statusChangeInOut:H,insideEntry:B,medicalSharjah:F,tajweehSubmission:$,iloeInsurance:U,healthInsurance:z,emirateId:J,residenceStamping:W,srilankaCouncilHead:_,upscoding:Q,labourFinePayment:G,labourCardRenewalPayment:K,servicePayment:X,visaStamping:Y,twoMonthVisitingVisa:Z,finePayment:ee,entryPermitOutside:ae,complaintEmployee:ie,arabicLetter:ne,violationCommittee:re,quotaModification:te,others:se,total:le}=o.data;s({employee:(c==null?void 0:c._id)||"",iBan:r||"",passportNumber:a||"",passportExpireDate:h||"",emirateIdNumber:t||"",emirateIdExpireDate:y||"",labourCardPersonalNumber:i||"",workPermitNumber:n||"",labourExpireDate:j||"",offerLetterTyping:R||"",labourInsurance:T||"",labourCardPayment:V||"",statusChangeInOut:H||"",insideEntry:B||"",medicalSharjah:F||"",tajweehSubmission:$||"",iloeInsurance:U||"",healthInsurance:z||"",emirateId:J||"",residenceStamping:W||"",srilankaCouncilHead:_||"",upscoding:Q||"",labourFinePayment:G||"",labourCardRenewalPayment:K||"",servicePayment:X||"",visaStamping:Y||"",twoMonthVisitingVisa:Z||"",finePayment:ee||"",entryPermitOutside:ae||"",complaintEmployee:ie||"",arabicLetter:ne||"",violationCommittee:re||"",quotaModification:te||"",others:se||"",total:le||""}),C(null)}catch(o){console.error("Error fetching visa expense report:",o),C(o.message||"Failed to load visa expense data"),S.push(e.jsx(E,{title:"Failed to fetch visa expense report data",type:"danger",duration:2500,children:o.message||"Something went wrong"}),{placement:"top-center"}),setTimeout(()=>x("/app/visa-expense-report-view"),2500)}finally{g(!1)}})()},[b,x]);const f=async(l,o)=>{var c,r,a,h;try{o(!0);const t={employee:l.employee,iBan:l.iBan,passportNumber:l.passportNumber,passportExpireDate:l.passportExpireDate,emirateIdNumber:l.emirateIdNumber,emirateIdExpireDate:l.emirateIdExpireDate,labourCardPersonalNumber:l.labourCardPersonalNumber,workPermitNumber:l.workPermitNumber,labourExpireDate:l.labourExpireDate,offerLetterTyping:l.offerLetterTyping,labourInsurance:l.labourInsurance,labourCardPayment:l.labourCardPayment,statusChangeInOut:l.statusChangeInOut,insideEntry:l.insideEntry,medicalSharjah:l.medicalSharjah,tajweehSubmission:l.tajweehSubmission,iloeInsurance:l.iloeInsurance,healthInsurance:l.healthInsurance,emirateId:l.emirateId,residenceStamping:l.residenceStamping,srilankaCouncilHead:l.srilankaCouncilHead,upscoding:l.upscoding,labourFinePayment:l.labourFinePayment,labourCardRenewalPayment:l.labourCardRenewalPayment,servicePayment:l.servicePayment,visaStamping:l.visaStamping,twoMonthVisitingVisa:l.twoMonthVisitingVisa,finePayment:l.finePayment,entryPermitOutside:l.entryPermitOutside,complaintEmployee:l.complaintEmployee,arabicLetter:l.arabicLetter,violationCommittee:l.violationCommittee,quotaModification:l.quotaModification,others:l.others,total:l.total},y=b?await ve(b,t):await Pe(t);if([200,201].includes(y.status))S.push(e.jsxs(E,{title:`Successfully ${b?"updated":"added"} visa expense report`,type:"success",duration:2500,children:["Visa expense report ",b?"updated":"added"," successfully"]}),{placement:"top-center"}),x("/app/visa-expense-report-view");else throw new Error(((r=(c=y==null?void 0:y.response)==null?void 0:c.data)==null?void 0:r.message)||"Unexpected status code")}catch(t){console.error("Form submission error:",t),S.push(e.jsx(E,{title:`Error ${b?"updating":"adding"} visa expense report`,type:"danger",duration:2500,children:((h=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:h.message)||t.message}),{placement:"top-center"})}finally{o(!1)}},w=()=>{JSON.stringify(I)!==JSON.stringify(O)?window.confirm("Are you sure you want to discard changes?")&&x("/app/visa-expense-report-view"):x("/app/visa-expense-report-view")};return N?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):P?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(E,{title:"Error loading visa expense report",type:"danger",children:P})}):e.jsx(q,{type:b?"edit":"new",initialData:I,onFormSubmit:f,onDiscard:w})};export{Ea as default};
