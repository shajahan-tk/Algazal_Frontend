import{r as x,j as e,v as oe,ak as me}from"./index-B-3YdMmO.js";import{N as C,t as w}from"./toast-xjy4rp4Y.js";import{F as pe,a as o}from"./FormItem-B_dHMuui.js";import{B as f}from"./Button-CfVbO-qU.js";import{S as ue}from"./StickyFooter-kVZ9pP5X.js";import{F as de,a as ce,b as m}from"./formik.esm-DIqlYRh2.js";import{A as be}from"./index-of15F68n.js";import{$ as he}from"./index-C7R1WpOH.js";import{c as ge,g as u,f as S,b as M}from"./index.esm-uYrHGYFJ.js";import"./Alert-QJLDMk5I.js";import"./index-Bo39LFtR.js";import"./Badge-B2PjptLi.js";import{D}from"./index-DCFjNNBJ.js";import"./Card-Dg6B2cp2.js";import"./Skeleton-C9LsrBBE.js";import"./Dialog-DSC5KQx1.js";import"./Drawer-CIBw5hlm.js";import"./index-DVAakj00.js";import"./useUniqueId-bhrNi0MA.js";import{I as p}from"./Input-m_H_R88b.js";import"./index-B_Yvn3dy.js";import"./index-Z4dDP0Pn.js";import"./index-BdrlLZgj.js";import"./index-5z68-iaN.js";import"./ScrollBar-C_iOIJGq.js";import{S as ye}from"./Select-DPSULLBa.js";import"./Upload-CuAXzTtV.js";import"./index-CqQ94ycg.js";import"./Tag-D_vNYl-M.js";import{A as O}from"./AdaptableCard-17ILPCDG.js";import"./Views-o_SZwizf.js";import"./chart.config-Cux27phG.js";import"./DataTable-CxfAxHEh.js";import"./SvgIcon-BC1C4FwK.js";import"./SegmentItemOption-CxYE_tKh.js";import{n as xe,N as je,O as ve,P as Ie}from"./api-C4nUkZdB.js";import"./StatusIcon-IxYTyNOx.js";import"./CloseButton-8arYtbYT.js";import"./chainedFunction-BxZSneMW.js";import"./proxy-nPFZIZ0Z.js";import"./context-_TTgW2bZ.js";import"./index-Dhg3PmVb.js";import"./cloneDeep-DJN0yfLA.js";import"./hoist-non-react-statics.cjs-VlwWE1Gk.js";import"./floating-ui.react-l_cC_yYr.js";import"./floating-ui.dom-B_iSk-nO.js";import"./useControllableState-HmMJSzbR.js";import"./_getPrototype-BJeMep-l.js";import"./index-BL9xzUQn.js";import"./toString-B2j7ZGf1.js";import"./index-CYY49BFP.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-BLqgq88H.js";import"./index-BYLbIXHY.js";import"./useThemeClass-BEUnEzZK.js";const k=x.forwardRef((h,c)=>{const{type:I,initialData:t={employee:"",iBan:"",passportNumber:"",passportExpireDate:"",emirateIdNumber:"",emirateIdExpireDate:"",labourCardPersonalNumber:"",workPermitNumber:"",labourExpireDate:"",offerLetterTyping:"0",labourInsurance:"0",labourCardPayment:"0",statusChangeInOut:"0",insideEntry:"0",medicalSharjah:"0",tajweehSubmission:"0",iloeInsurance:"0",healthInsurance:"0",emirateId:"0",residenceStamping:"0",srilankaCouncilHead:"0",upscoding:"0",labourFinePayment:"0",labourCardRenewalPayment:"0",servicePayment:"0",visaStamping:"0",twoMonthVisitingVisa:"0",finePayment:"0",entryPermitOutside:"0",complaintEmployee:"0",arabicLetter:"0",violationCommittee:"0",quotaModification:"0",others:"0"},onFormSubmit:P,onDiscard:g,onDelete:j}=h,[v,E]=x.useState([]);x.useEffect(()=>{(async()=>{var s;try{const i=await xe();console.log(i,"response");const b=(s=i.data)==null?void 0:s.users.map(l=>({value:l._id,label:`${l.firstName} ${l.lastName}`,passportNumber:l.passportNumber,emirateIdNumber:l.emiratesId}));E(b),!t.passportNumber&&!t.emirateIdNumber&&b.length>0&&(setFieldValue("passportNumber",b[0].passportNumber||""),setFieldValue("emirateIdNumber",b[0].emirateIdNumber||""))}catch(i){console.error("Failed to fetch users",i)}})()},[t.passportNumber,t.emirateIdNumber]);const N=ge().shape({employee:M().required("Employee is required"),passportNumber:M().required("Passport number is required"),emirateIdNumber:M().required("Emirate ID number is required"),passportExpireDate:S().required("Passport expiry date is required"),emirateIdExpireDate:S().required("Emirate ID expiry date is required"),labourExpireDate:S().required("Labour card expiry date is required"),offerLetterTyping:u().min(0),labourInsurance:u().min(0),labourCardPayment:u().min(0),statusChangeInOut:u().min(0),insideEntry:u().min(0),medicalSharjah:u().min(0),tajweehSubmission:u().min(0),iloeInsurance:u().min(0),healthInsurance:u().min(0),emirateId:u().min(0),residenceStamping:u().min(0),srilankaCouncilHead:u().min(0),upscoding:u().min(0),labourFinePayment:u().min(0),labourCardRenewalPayment:u().min(0),servicePayment:u().min(0),visaStamping:u().min(0),twoMonthVisitingVisa:u().min(0),finePayment:u().min(0),entryPermitOutside:u().min(0),complaintEmployee:u().min(0),arabicLetter:u().min(0),violationCommittee:u().min(0),quotaModification:u().min(0),others:u().min(0)}),n=(d,s,i,b)=>{i(d,s)};return e.jsx(de,{innerRef:c,initialValues:{employee:t.employee||"",iBan:t.iBan||"",passportNumber:t.passportNumber||"",passportExpireDate:t.passportExpireDate instanceof Date?t.passportExpireDate:t.passportExpireDate?new Date(t.passportExpireDate):null,emirateIdNumber:t.emirateIdNumber||"",emirateIdExpireDate:t.emirateIdExpireDate instanceof Date?t.emirateIdExpireDate:t.emirateIdExpireDate?new Date(t.emirateIdExpireDate):null,labourCardPersonalNumber:t.labourCardPersonalNumber||"",workPermitNumber:t.workPermitNumber||"",labourExpireDate:t.labourExpireDate instanceof Date?t.labourExpireDate:t.labourExpireDate?new Date(t.labourExpireDate):null,offerLetterTyping:t.offerLetterTyping||"0",labourInsurance:t.labourInsurance||"0",labourCardPayment:t.labourCardPayment||"0",statusChangeInOut:t.statusChangeInOut||"0",insideEntry:t.insideEntry||"0",medicalSharjah:t.medicalSharjah||"0",tajweehSubmission:t.tajweehSubmission||"0",iloeInsurance:t.iloeInsurance||"0",healthInsurance:t.healthInsurance||"0",emirateId:t.emirateId||"0",residenceStamping:t.residenceStamping||"0",srilankaCouncilHead:t.srilankaCouncilHead||"0",upscoding:t.upscoding||"0",labourFinePayment:t.labourFinePayment||"0",labourCardRenewalPayment:t.labourCardRenewalPayment||"0",servicePayment:t.servicePayment||"0",visaStamping:t.visaStamping||"0",twoMonthVisitingVisa:t.twoMonthVisitingVisa||"0",finePayment:t.finePayment||"0",entryPermitOutside:t.entryPermitOutside||"0",complaintEmployee:t.complaintEmployee||"0",arabicLetter:t.arabicLetter||"0",violationCommittee:t.violationCommittee||"0",quotaModification:t.quotaModification||"0",others:t.others||"0"},validationSchema:N,onSubmit:async(d,{setSubmitting:s})=>{try{await P(d,s)}catch(i){s(!1),console.error("Form submission error:",i)}},enableReinitialize:!0,children:({values:d,touched:s,errors:i,isSubmitting:b,setFieldValue:l})=>e.jsx(ce,{children:e.jsxs(pe,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs(O,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Employee Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(o,{label:"Employee",invalid:!!i.employee&&s.employee,errorMessage:i.employee,children:e.jsx(ye,{options:v,value:v.filter(a=>a.value===d.employee),onChange:a=>{l("employee",a==null?void 0:a.value),a&&(l("passportNumber",a.passportNumber||""),l("emirateIdNumber",a.emirateIdNumber||""))}})}),e.jsx(o,{label:"IBAN",invalid:!!i.iBan&&s.iBan,errorMessage:i.iBan,children:e.jsx(m,{name:"iBan",children:({field:a})=>e.jsx(p,{placeholder:"IBAN",...a})})}),e.jsx(o,{label:"Passport Number",invalid:!!i.passportNumber&&s.passportNumber,errorMessage:i.passportNumber,children:e.jsx(m,{name:"passportNumber",children:({field:a})=>e.jsx(p,{placeholder:"Passport Number",...a})})}),e.jsx(o,{label:"Passport Expiry Date",invalid:!!i.passportExpireDate&&s.passportExpireDate,errorMessage:i.passportExpireDate,children:e.jsx(m,{name:"passportExpireDate",children:({field:a,form:r})=>e.jsx(D,{placeholder:"Select Passport Expiry Date",value:a.value?new Date(a.value):null,onChange:y=>r.setFieldValue(a.name,y)})})}),e.jsx(o,{label:"Emirate ID Number",invalid:!!i.emirateIdNumber&&s.emirateIdNumber,errorMessage:i.emirateIdNumber,children:e.jsx(m,{name:"emirateIdNumber",children:({field:a})=>e.jsx(p,{placeholder:"Emirate ID Number",...a})})}),e.jsx(o,{label:"Emirate ID Expiry Date",invalid:!!i.emirateIdExpireDate&&s.emirateIdExpireDate,errorMessage:i.emirateIdExpireDate,children:e.jsx(m,{name:"emirateIdExpireDate",children:({field:a,form:r})=>e.jsx(D,{placeholder:"Select Emirate ID Expiry Date",value:a.value?new Date(a.value):null,onChange:y=>r.setFieldValue(a.name,y)})})}),e.jsx(o,{label:"Labour Card Personal Number",invalid:!!i.labourCardPersonalNumber&&s.labourCardPersonalNumber,errorMessage:i.labourCardPersonalNumber,children:e.jsx(m,{name:"labourCardPersonalNumber",children:({field:a})=>e.jsx(p,{placeholder:"Labour Card Personal Number",...a})})}),e.jsx(o,{label:"Work Permit Number",invalid:!!i.workPermitNumber&&s.workPermitNumber,errorMessage:i.workPermitNumber,children:e.jsx(m,{name:"workPermitNumber",children:({field:a})=>e.jsx(p,{placeholder:"Work Permit Number",...a})})}),e.jsx(o,{label:"Labour Card Expiry Date",invalid:!!i.labourExpireDate&&s.labourExpireDate,errorMessage:i.labourExpireDate,children:e.jsx(m,{name:"labourExpireDate",children:({field:a,form:r})=>e.jsx(D,{placeholder:"Select Labour Card Expiry Date",value:a.value?new Date(a.value):null,onChange:y=>r.setFieldValue(a.name,y)})})})]})]}),e.jsxs(O,{divider:!0,className:"mb-4",children:[e.jsx("h5",{className:"mb-4",children:"Visa Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(o,{label:"Offer Letter Typing",invalid:!!i.offerLetterTyping&&s.offerLetterTyping,errorMessage:i.offerLetterTyping,children:e.jsx(m,{name:"offerLetterTyping",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("offerLetterTyping",r.target.value,l)})})}),e.jsx(o,{label:"Labour Insurance",invalid:!!i.labourInsurance&&s.labourInsurance,errorMessage:i.labourInsurance,children:e.jsx(m,{name:"labourInsurance",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("labourInsurance",r.target.value,l)})})}),e.jsx(o,{label:"Labour Card Payment",invalid:!!i.labourCardPayment&&s.labourCardPayment,errorMessage:i.labourCardPayment,children:e.jsx(m,{name:"labourCardPayment",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("labourCardPayment",r.target.value,l)})})}),e.jsx(o,{label:"Status Change In/Out",invalid:!!i.statusChangeInOut&&s.statusChangeInOut,errorMessage:i.statusChangeInOut,children:e.jsx(m,{name:"statusChangeInOut",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("statusChangeInOut",r.target.value,l)})})}),e.jsx(o,{label:"Inside Entry",invalid:!!i.insideEntry&&s.insideEntry,errorMessage:i.insideEntry,children:e.jsx(m,{name:"insideEntry",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("insideEntry",r.target.value,l)})})}),e.jsx(o,{label:"Medical Sharjah",invalid:!!i.medicalSharjah&&s.medicalSharjah,errorMessage:i.medicalSharjah,children:e.jsx(m,{name:"medicalSharjah",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("medicalSharjah",r.target.value,l)})})}),e.jsx(o,{label:"Tajweeh Submission",invalid:!!i.tajweehSubmission&&s.tajweehSubmission,errorMessage:i.tajweehSubmission,children:e.jsx(m,{name:"tajweehSubmission",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("tajweehSubmission",r.target.value,l)})})}),e.jsx(o,{label:"ILOE Insurance",invalid:!!i.iloeInsurance&&s.iloeInsurance,errorMessage:i.iloeInsurance,children:e.jsx(m,{name:"iloeInsurance",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("iloeInsurance",r.target.value,l)})})}),e.jsx(o,{label:"Health Insurance",invalid:!!i.healthInsurance&&s.healthInsurance,errorMessage:i.healthInsurance,children:e.jsx(m,{name:"healthInsurance",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("healthInsurance",r.target.value,l)})})}),e.jsx(o,{label:"Emirate ID",invalid:!!i.emirateId&&s.emirateId,errorMessage:i.emirateId,children:e.jsx(m,{name:"emirateId",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("emirateId",r.target.value,l)})})}),e.jsx(o,{label:"Residence Stamping",invalid:!!i.residenceStamping&&s.residenceStamping,errorMessage:i.residenceStamping,children:e.jsx(m,{name:"residenceStamping",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("residenceStamping",r.target.value,l)})})}),e.jsx(o,{label:"Srilanka Council Head",invalid:!!i.srilankaCouncilHead&&s.srilankaCouncilHead,errorMessage:i.srilankaCouncilHead,children:e.jsx(m,{name:"srilankaCouncilHead",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("srilankaCouncilHead",r.target.value,l)})})}),e.jsx(o,{label:"Upscoding",invalid:!!i.upscoding&&s.upscoding,errorMessage:i.upscoding,children:e.jsx(m,{name:"upscoding",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("upscoding",r.target.value,l)})})}),e.jsx(o,{label:"Labour Fine Payment",invalid:!!i.labourFinePayment&&s.labourFinePayment,errorMessage:i.labourFinePayment,children:e.jsx(m,{name:"labourFinePayment",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("labourFinePayment",r.target.value,l)})})}),e.jsx(o,{label:"Labour Card Renewal Payment",invalid:!!i.labourCardRenewalPayment&&s.labourCardRenewalPayment,errorMessage:i.labourCardRenewalPayment,children:e.jsx(m,{name:"labourCardRenewalPayment",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("labourCardRenewalPayment",r.target.value,l)})})}),e.jsx(o,{label:"Service Payment",invalid:!!i.servicePayment&&s.servicePayment,errorMessage:i.servicePayment,children:e.jsx(m,{name:"servicePayment",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("servicePayment",r.target.value,l)})})}),e.jsx(o,{label:"Visa Stamping",invalid:!!i.visaStamping&&s.visaStamping,errorMessage:i.visaStamping,children:e.jsx(m,{name:"visaStamping",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("visaStamping",r.target.value,l)})})}),e.jsx(o,{label:"Two Month Visiting Visa",invalid:!!i.twoMonthVisitingVisa&&s.twoMonthVisitingVisa,errorMessage:i.twoMonthVisitingVisa,children:e.jsx(m,{name:"twoMonthVisitingVisa",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("twoMonthVisitingVisa",r.target.value,l)})})}),e.jsx(o,{label:"Fine Payment",invalid:!!i.finePayment&&s.finePayment,errorMessage:i.finePayment,children:e.jsx(m,{name:"finePayment",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("finePayment",r.target.value,l)})})}),e.jsx(o,{label:"Entry Permit Outside",invalid:!!i.entryPermitOutside&&s.entryPermitOutside,errorMessage:i.entryPermitOutside,children:e.jsx(m,{name:"entryPermitOutside",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("entryPermitOutside",r.target.value,l)})})}),e.jsx(o,{label:"Complaint Employee",invalid:!!i.complaintEmployee&&s.complaintEmployee,errorMessage:i.complaintEmployee,children:e.jsx(m,{name:"complaintEmployee",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("complaintEmployee",r.target.value,l)})})}),e.jsx(o,{label:"Arabic Letter",invalid:!!i.arabicLetter&&s.arabicLetter,errorMessage:i.arabicLetter,children:e.jsx(m,{name:"arabicLetter",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("arabicLetter",r.target.value,l)})})}),e.jsx(o,{label:"Violation Committee",invalid:!!i.violationCommittee&&s.violationCommittee,errorMessage:i.violationCommittee,children:e.jsx(m,{name:"violationCommittee",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("violationCommittee",r.target.value,l)})})}),e.jsx(o,{label:"Quota Modification",invalid:!!i.quotaModification&&s.quotaModification,errorMessage:i.quotaModification,children:e.jsx(m,{name:"quotaModification",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("quotaModification",r.target.value,l)})})}),e.jsx(o,{label:"Others",invalid:!!i.others&&s.others,errorMessage:i.others,children:e.jsx(m,{name:"others",children:({field:a})=>e.jsx(p,{type:"number",placeholder:"Amount",...a,onChange:r=>n("others",r.target.value,l)})})}),e.jsx("div",{className:"col-span-2"})]})]})]})}),e.jsxs(ue,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:I==="edit"&&j&&e.jsx(f,{size:"sm",variant:"plain",color:"red",icon:e.jsx(he,{}),type:"button",onClick:()=>j(()=>{}),children:"Delete"})}),e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(f,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>g==null?void 0:g(),children:"Discard"}),e.jsx(f,{size:"sm",variant:"solid",loading:b,icon:e.jsx(be,{}),type:"submit",children:"Save"})]})]})]})})})});k.displayName="VisaExpenseForm";const L={employee:"",iBan:"",passportNumber:"",passportExpireDate:"",emirateIdNumber:"",emirateIdExpireDate:"",labourCardPersonalNumber:"",workPermitNumber:"",labourExpireDate:"",offerLetterTyping:"",labourInsurance:"",labourCardPayment:"",statusChangeInOut:"",insideEntry:"",medicalSharjah:"",tajweehSubmission:"",iloeInsurance:"",healthInsurance:"",emirateId:"",residenceStamping:"",srilankaCouncilHead:"",upscoding:"",labourFinePayment:"",labourCardRenewalPayment:"",servicePayment:"",visaStamping:"",twoMonthVisitingVisa:"",finePayment:"",entryPermitOutside:"",complaintEmployee:"",arabicLetter:"",violationCommittee:"",quotaModification:"",others:"",total:""},Ea=()=>{const h=oe(),{id:c}=me(),[I,t]=x.useState(L),[P,g]=x.useState(!!c),[j,v]=x.useState(null);x.useEffect(()=>{if(!c){t(L),g(!1);return}(async()=>{try{g(!0);const d=await je(c);if(!(d!=null&&d.data))throw new Error("Invalid visa expense data received");const{employee:s,iBan:i,passportNumber:b,passportExpireDate:l,emirateIdNumber:a,emirateIdExpireDate:r,labourCardPersonalNumber:y,workPermitNumber:A,labourExpireDate:q,offerLetterTyping:R,labourInsurance:V,labourCardPayment:T,statusChangeInOut:B,insideEntry:H,medicalSharjah:F,tajweehSubmission:$,iloeInsurance:U,healthInsurance:z,emirateId:J,residenceStamping:W,srilankaCouncilHead:_,upscoding:Q,labourFinePayment:G,labourCardRenewalPayment:K,servicePayment:X,visaStamping:Y,twoMonthVisitingVisa:Z,finePayment:ee,entryPermitOutside:ae,complaintEmployee:ie,arabicLetter:ne,violationCommittee:re,quotaModification:te,others:se,total:le}=d.data;t({employee:(s==null?void 0:s._id)||"",iBan:i||"",passportNumber:b||"",passportExpireDate:l||"",emirateIdNumber:a||"",emirateIdExpireDate:r||"",labourCardPersonalNumber:y||"",workPermitNumber:A||"",labourExpireDate:q||"",offerLetterTyping:R||"",labourInsurance:V||"",labourCardPayment:T||"",statusChangeInOut:B||"",insideEntry:H||"",medicalSharjah:F||"",tajweehSubmission:$||"",iloeInsurance:U||"",healthInsurance:z||"",emirateId:J||"",residenceStamping:W||"",srilankaCouncilHead:_||"",upscoding:Q||"",labourFinePayment:G||"",labourCardRenewalPayment:K||"",servicePayment:X||"",visaStamping:Y||"",twoMonthVisitingVisa:Z||"",finePayment:ee||"",entryPermitOutside:ae||"",complaintEmployee:ie||"",arabicLetter:ne||"",violationCommittee:re||"",quotaModification:te||"",others:se||"",total:le||""}),v(null)}catch(d){console.error("Error fetching visa expense report:",d),v(d.message||"Failed to load visa expense data"),w.push(e.jsx(C,{title:"Failed to fetch visa expense report data",type:"danger",duration:2500,children:d.message||"Something went wrong"}),{placement:"top-center"}),setTimeout(()=>h("/app/visa-expense-report-view"),2500)}finally{g(!1)}})()},[c,h]);const E=async(n,d)=>{var s,i,b,l;try{d(!0);const a={employee:n.employee,iBan:n.iBan,passportNumber:n.passportNumber,passportExpireDate:n.passportExpireDate,emirateIdNumber:n.emirateIdNumber,emirateIdExpireDate:n.emirateIdExpireDate,labourCardPersonalNumber:n.labourCardPersonalNumber,workPermitNumber:n.workPermitNumber,labourExpireDate:n.labourExpireDate,offerLetterTyping:n.offerLetterTyping,labourInsurance:n.labourInsurance,labourCardPayment:n.labourCardPayment,statusChangeInOut:n.statusChangeInOut,insideEntry:n.insideEntry,medicalSharjah:n.medicalSharjah,tajweehSubmission:n.tajweehSubmission,iloeInsurance:n.iloeInsurance,healthInsurance:n.healthInsurance,emirateId:n.emirateId,residenceStamping:n.residenceStamping,srilankaCouncilHead:n.srilankaCouncilHead,upscoding:n.upscoding,labourFinePayment:n.labourFinePayment,labourCardRenewalPayment:n.labourCardRenewalPayment,servicePayment:n.servicePayment,visaStamping:n.visaStamping,twoMonthVisitingVisa:n.twoMonthVisitingVisa,finePayment:n.finePayment,entryPermitOutside:n.entryPermitOutside,complaintEmployee:n.complaintEmployee,arabicLetter:n.arabicLetter,violationCommittee:n.violationCommittee,quotaModification:n.quotaModification,others:n.others,total:n.total},r=c?await ve(c,a):await Ie(a);if([200,201].includes(r.status))w.push(e.jsxs(C,{title:`Successfully ${c?"updated":"added"} visa expense report`,type:"success",duration:2500,children:["Visa expense report ",c?"updated":"added"," successfully"]}),{placement:"top-center"}),h("/app/visa-expense-report-viewview");else throw new Error(((i=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:i.message)||"Unexpected status code")}catch(a){console.error("Form submission error:",a),w.push(e.jsx(C,{title:`Error ${c?"updating":"adding"} visa expense report`,type:"danger",duration:2500,children:((l=(b=a==null?void 0:a.response)==null?void 0:b.data)==null?void 0:l.message)||a.message}),{placement:"top-center"})}finally{d(!1)}},N=()=>{JSON.stringify(I)!==JSON.stringify(L)?window.confirm("Are you sure you want to discard changes?")&&h("/app/visa-expense-view"):h("/app/visa-expense-view")};return P?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):j?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(C,{title:"Error loading visa expense report",type:"danger",children:j})}):e.jsx(k,{type:c?"edit":"new",initialData:I,onFormSubmit:E,onDiscard:N})};export{Ea as default};
