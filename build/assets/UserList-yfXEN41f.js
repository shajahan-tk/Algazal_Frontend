import{ab as K,aa as M,ac as _,ad as H,r as u,j as e,v as V,a as P,m as q,ae as B}from"./index-CDUqAS1l.js";import{a as G}from"./SalesService-CTnArLP2.js";import{A as Q}from"./AdaptableCard-BXZ7gMWR.js";import{A as W}from"./index-C1Nx0TEh.js";import{B as X}from"./Badge-hMcflglf.js";import{D as Y}from"./DataTable-CVcq30BR.js";import{O as Z,W as J,X as k,Y as ee,Z as se,_ as ae}from"./index-BerpkDBA.js";import{F as te}from"./index-fGJtQcqw.js";import{u as re}from"./useThemeClass-5GKJG2gx.js";import{u as le}from"./useQuery-Bhl94K2J.js";import{d as w}from"./debounce-D6G_2h-R.js";import{I as y}from"./Input-DXBk0KXn.js";import{b as oe,c as ne}from"./api-DtX_23JY.js";import{B as g}from"./Button-BPBskG9o.js";import{c as ie,C as d}from"./Skeleton-DoyxclK2.js";import{F as ce,a as f}from"./FormItem-ByEmqHQ5.js";import{R as j}from"./index-ChKfPKLA.js";import{D as me}from"./Drawer-peSRAyXS.js";import{F as de,a as ue,b}from"./formik.esm-D7-nrDq7.js";import{F as pe}from"./FileSaver.min-HLzuDYGF.js";import{t as F,N as D}from"./toast-DGerJIJB.js";import"./Card-Bb8Omztx.js";import"./floating-ui.react-CCBWD0pR.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-CJy_8sJq.js";import"./proxy-Dk6QltiT.js";import"./index-CocX0oO3.js";import"./index-CBdLSIrO.js";import"./Select-Bc7Wf5rB.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-BmYztAKh.js";import"./Views-DmS3tele.js";import"./context-D-kJGxG9.js";import"./index-B2bfEVVx.js";import"./toString-DOI2nrr_.js";import"./_getPrototype-CIMlDKAv.js";import"./index-CjDcj2AV.js";import"./CloseButton-BXRa_ZJ2.js";import"./cloneDeep-DJN0yfLA.js";import"./StatusIcon-twe9Eqr7.js";import"./chainedFunction-BxZSneMW.js";const A="salesProductList",v=M(A+"/getProducts",async s=>(await G(s)).data),E={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},he={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:E,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},R=K({name:`${A}/state`,initialState:he,reducers:{updateProductList:(s,a)=>{s.productList=a.payload},setTableData:(s,a)=>{s.tableData=a.payload},setFilterData:(s,a)=>{s.filterData=a.payload},toggleDeleteConfirmation:(s,a)=>{s.deleteConfirmation=a.payload},setSelectedProduct:(s,a)=>{s.selectedProduct=a.payload}},extraReducers:s=>{s.addCase(v.fulfilled,(a,n)=>{a.productList=n.payload.data,a.tableData.total=n.payload.total,a.loading=!1}).addCase(v.pending,a=>{a.loading=!0})}}),{updateProductList:xs,setTableData:xe,setFilterData:ge,toggleDeleteConfirmation:gs,setSelectedProduct:fs}=R.actions,fe=R.reducer,je=H({data:fe}),I=_,be={true:{label:"Active",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},false:{label:"Inactive",dotClass:"bg-red-500",textClass:"text-red-500"}},ve=({row:s})=>{const{textTheme:a}=re(),n=V(),i=()=>{n(`/app/user-form/${s._id}`)},c=()=>{n(`/app/user-view/${s==null?void 0:s._id}`)};return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:c,children:e.jsx(Z,{})}),e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:i,children:e.jsx(J,{})})]})},Ne=({row:s})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{src:s.profileImage,icon:e.jsx(te,{}),alt:`${s.firstName} ${s.lastName}`}),e.jsxs("span",{className:"ml-2 rtl:mr-2 font-semibold",children:[s.firstName," ",s.lastName]})]}),ye=()=>{var C,S;const s=u.useRef(null),[a,n]=u.useState(""),[i,c]=u.useState({page:1,limit:10}),{data:r,isLoading:m,error:t,refetch:l}=le({queryKey:["users",i.page,i.limit,a],queryFn:()=>oe({page:i.page,limit:i.limit})}),x=((C=r==null?void 0:r.data)==null?void 0:C.users)||[],p=((S=r==null?void 0:r.data)==null?void 0:S.pagination)||{total:0,page:1,limit:10},T=u.useMemo(()=>w(o=>{n(o),c(h=>({...h,page:1}))},500),[]),z=o=>{T(o.target.value)},O=u.useMemo(()=>[{header:"Name",accessorKey:"name",cell:o=>e.jsx(Ne,{row:o.row.original})},{header:"Email",accessorKey:"email",cell:o=>e.jsx("span",{children:o.row.original.email})},{header:"Phone Number",accessorKey:"phoneNumbers",cell:o=>{var h;return e.jsx("span",{children:((h=o.row.original.phoneNumbers)==null?void 0:h[0])||"N/A"})}},{header:"Role",accessorKey:"role",cell:o=>e.jsx("span",{className:"capitalize",children:o.row.original.role})},{header:"Status",accessorKey:"isActive",cell:o=>{const h=o.row.original.isActive,N=be[h.toString()];return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:N.dotClass}),e.jsx("span",{className:`capitalize font-semibold ${N.textClass}`,children:N.label})]})}},{header:"Action",id:"action",cell:o=>e.jsx(ve,{row:o.row.original})}],[]),U=o=>{c(h=>({...h,page:o}))},$=o=>{c(h=>({page:1,limit:o}))};return t?e.jsxs("div",{children:["Error loading users: ",t.message]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(y,{placeholder:"Search users...",onChange:z,className:"max-w-md"})}),e.jsx(Y,{ref:s,columns:O,data:x,skeletonAvatarColumns:[0,3,4],skeletonAvatarProps:{className:"rounded-md"},loading:m,pagingData:{total:p.total,pageIndex:p.page,pageSize:p.limit},onPaginationChange:U,onSelectChange:$})]})},Ce=()=>{const s=P(),a=u.useRef(null),n=I(t=>t.salesProductList.data.tableData),i=w(c,500);function c(t){const l=ie(n);l.query=t,l.pageIndex=1,typeof t=="string"&&t.length>1&&r(l),typeof t=="string"&&t.length===0&&r(l)}const r=t=>{s(xe(t)),s(v(t))},m=t=>{i(t.target.value)};return e.jsx(y,{ref:a,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search product",prefix:e.jsx(k,{className:"text-lg"}),onChange:m})},L=u.forwardRef(({onSubmitComplete:s},a)=>{const n=P(),i=I(r=>r.salesProductList.data.filterData),c=r=>{s==null||s(),n(ge(r)),n(v(E))};return e.jsx(de,{enableReinitialize:!0,innerRef:a,initialValues:i,onSubmit:r=>{c(r)},children:({values:r,touched:m,errors:t})=>e.jsx(ue,{children:e.jsxs(ce,{children:[e.jsxs(f,{invalid:t.name&&m.name,errorMessage:t.name,children:[e.jsx("h6",{className:"mb-4",children:"Included text"}),e.jsx(b,{type:"text",autoComplete:"off",name:"name",placeholder:"Keyword",component:y,prefix:e.jsx(k,{className:"text-lg"})})]}),e.jsxs(f,{invalid:t.category&&m.category,errorMessage:t.category,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(b,{name:"category",children:({field:l,form:x})=>e.jsx(e.Fragment,{children:e.jsxs(d.Group,{vertical:!0,value:r.category,onChange:p=>x.setFieldValue(l.name,p),children:[e.jsxs(d,{className:"mb-3",name:l.name,value:"bags",children:["Bags"," "]}),e.jsxs(d,{className:"mb-3",name:l.name,value:"cloths",children:["Cloths"," "]}),e.jsxs(d,{className:"mb-3",name:l.name,value:"devices",children:["Devices"," "]}),e.jsxs(d,{className:"mb-3",name:l.name,value:"shoes",children:["Shoes"," "]}),e.jsxs(d,{name:l.name,value:"watches",children:["Watches"," "]})]})})})]}),e.jsxs(f,{invalid:t.status&&m.status,errorMessage:t.status,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(b,{name:"status",children:({field:l,form:x})=>e.jsx(e.Fragment,{children:e.jsxs(d.Group,{vertical:!0,value:r.status,onChange:p=>x.setFieldValue(l.name,p),children:[e.jsxs(d,{className:"mb-3",name:l.name,value:0,children:["In Stock"," "]}),e.jsxs(d,{className:"mb-3",name:l.name,value:1,children:["Limited"," "]}),e.jsxs(d,{className:"mb-3",name:l.name,value:2,children:["Out Of Stock"," "]})]})})})]}),e.jsxs(f,{invalid:t.productStatus&&m.productStatus,errorMessage:t.productStatus,children:[e.jsx("h6",{className:"mb-4",children:"Product Status"}),e.jsx(b,{name:"productStatus",children:({field:l,form:x})=>e.jsxs(j.Group,{vertical:!0,value:r.productStatus,onChange:p=>x.setFieldValue(l.name,p),children:[e.jsx(j,{value:0,children:"Published"}),e.jsx(j,{value:1,children:"Disabled"}),e.jsx(j,{value:2,children:"Archive"})]})})]})]})})})}),Se=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(g,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(g,{size:"sm",variant:"solid",onClick:s,children:"Query"})]}),Fe=()=>{const s=u.useRef(null),[a,n]=u.useState(!1),i=()=>{n(!0)},c=()=>{n(!1)},r=()=>{var m;(m=s.current)==null||m.submitForm()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(ee,{}),onClick:()=>i(),children:"Filter"}),e.jsx(me,{title:"Filter",isOpen:a,footer:e.jsx(Se,{onCancel:c,onSaveClick:r}),onClose:c,onRequestClose:c,children:e.jsx(L,{ref:s,onSubmitComplete:c})})]})};L.displayName="FilterForm";const De=()=>{const[s,a]=u.useState(!1),n=async()=>{a(!0);try{const i=await ne();pe.saveAs(i,`users_export_${new Date().toISOString().slice(0,10)}.csv`),F.push(e.jsx(D,{title:"Export Successful",type:"success",children:"User data has been exported successfully"}),{placement:"top-center"})}catch(i){console.error("Export failed:",i),F.push(e.jsx(D,{title:"Export Failed",type:"danger",children:"Failed to export user data. Please try again."}),{placement:"top-center"})}finally{a(!1)}};return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[e.jsx(Ce,{}),e.jsx(Fe,{}),e.jsx(g,{className:"md:mb-0 mb-4",size:"sm",icon:e.jsx(se,{}),loading:s,onClick:n,children:s?"Exporting...":"Export"}),e.jsx(q,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/user-new",children:e.jsx(g,{block:!0,variant:"solid",size:"sm",icon:e.jsx(ae,{}),children:"Add Staff"})})]})};B("salesProductList",je);const js=()=>e.jsxs(Q,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Staffs"}),e.jsx(De,{})]}),e.jsx(ye,{})]});export{js as default};
