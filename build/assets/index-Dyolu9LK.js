import{aa as W,ab as L,ac as P,ad as E,j as e,r as m,n as N,a4 as A,a as Y,ae as F}from"./index-CDUqAS1l.js";import{a as I}from"./ProjectService-D-QbCyJ5.js";import{C as v}from"./Card-Bb8Omztx.js";import{a as h}from"./index-Dk4smkVo.js";import{B as J}from"./Badge-hMcflglf.js";import{a as C,b as _,c as B,d as $,A as G,C as k}from"./chart.config-CZuakYno.js";import{i as z}from"./Views-DmS3tele.js";import{P as R,Q as H}from"./index-BerpkDBA.js";import{m as U}from"./proxy-Dk6QltiT.js";import"./Alert-DL8X4Uab.js";import"./index-C1Nx0TEh.js";import"./Button-BPBskG9o.js";import"./index-CRkWz9hY.js";import"./Skeleton-DoyxclK2.js";import"./Dialog-C7AMlNhG.js";import"./Drawer-peSRAyXS.js";import"./index-DvFxqpjx.js";import"./FormItem-ByEmqHQ5.js";import"./useUniqueId-CQBDBfVD.js";import"./Input-DXBk0KXn.js";import"./index-cjDbE1Ce.js";import"./toast-DGerJIJB.js";import"./index-DQYmJabE.js";import"./index-ChKfPKLA.js";import"./ScrollBar-QR2Zwrhq.js";import"./Select-Bc7Wf5rB.js";import"./Upload-BJb1fzL_.js";import"./index-CocX0oO3.js";import"./Tag-Bq5dzNE2.js";import{g as q,a as Q}from"./api-DQdmRQDg.js";import"./useControllableState-DyX12gyY.js";import"./context-D-kJGxG9.js";import"./index-CjDcj2AV.js";import"./StatusIcon-twe9Eqr7.js";import"./CloseButton-BXRa_ZJ2.js";import"./floating-ui.react-CCBWD0pR.js";import"./floating-ui.dom-B_iSk-nO.js";import"./index-CJy_8sJq.js";import"./_getPrototype-CIMlDKAv.js";import"./toString-DOI2nrr_.js";import"./chainedFunction-BxZSneMW.js";import"./index-DlSvysZf.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-BmYztAKh.js";import"./index-CBdLSIrO.js";const T="projectDashboard",O=W(T+"/getProjectDashboardData",async()=>(await I()).data),V={loading:!0,dashboardData:{}},K=L({name:`${T}/state`,initialState:V,reducers:{},extraReducers:t=>{t.addCase(O.fulfilled,(a,s)=>{a.dashboardData=s.payload,a.loading=!1}).addCase(O.pending,a=>{a.loading=!0})}}),X=K.reducer,Z=E({data:X}),ee=P,te=({userName:t,taskCount:a})=>e.jsx("div",{children:e.jsxs("h4",{className:"mb-1",children:["Hello, ",t,"!"]})}),S=["line","bar","area"],ae=t=>{const{series:a=[],width:s="100%",height:n=300,xAxis:d,customOptions:i,type:o="line",direction:c,donutTitle:b,donutText:f,className:l,...p}=t,u=m.useRef(null),x=m.useMemo(()=>{switch(o){case"line":return C;case"bar":return $;case"area":return B;case"donut":return _;default:return C}},[o]);let r=JSON.parse(JSON.stringify(x));const w=window.innerWidth<768,D=m.useCallback(()=>{if(u.current){const g=u.current.querySelectorAll("div.apexcharts-legend")[0];c===N&&(g.style.right="auto",g.style.left="0"),w&&(g.style.position="relative",g.style.top="0",g.style.justifyContent="start",g.style.padding="0")}},[c,w]);return m.useEffect(()=>{S.includes(o)&&D()},[o,D]),S.includes(o)&&(r.xaxis.categories=d),i&&(r={...r,...i}),o==="donut"&&(b&&(r.plotOptions.pie.donut.labels.total.label=b),f&&(r.plotOptions.pie.donut.labels.total.formatter=()=>f)),e.jsx("div",{ref:u,style:c===N?{direction:"ltr"}:{},className:"chartRef",children:e.jsx(G,{options:r,type:o,series:a,width:s,height:n,className:l,...p})})},j=({label:t,value:a,badgeClass:s,showBadge:n=!0})=>e.jsxs("div",{className:"flex gap-2",children:[n&&e.jsx(J,{className:"mt-2.5",innerClass:s}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold",children:a}),e.jsx("p",{children:t})]})]}),se=({data:t={},className:a})=>{const[s,n]=m.useState(["weekly"]),[d,i]=m.useState(!1),o=ee(c=>c.theme.layout.sideNavCollapse);return m.useEffect(()=>{i(!0);const c=setTimeout(()=>i(!1),300);return()=>{clearTimeout(c)}},[t,o]),e.jsxs(v,{className:a,children:[e.jsxs("div",{className:"flex sm:flex-row flex-col md:items-center justify-between mb-6 gap-4",children:[e.jsx("h4",{children:"Task Overview"}),e.jsxs(h,{value:s,size:"sm",onChange:c=>n(c),children:[e.jsx(h.Item,{value:"monthly",children:"Monthly"}),e.jsx(h.Item,{value:"weekly",children:"Weekly"}),e.jsx(h.Item,{value:"daily",children:"Daily"})]})]}),!z(t)&&!d&&t.chart&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsx(j,{showBadge:!1,label:"Total Tasks",value:t.chart[s[0]].total})}),e.jsxs("div",{className:"flex gap-x-6",children:[e.jsx(j,{badgeClass:"bg-indigo-600",label:t.chart[s[0]].series[0].name,value:t.chart[s[0]].onGoing}),e.jsx(j,{badgeClass:"bg-emerald-500",label:t.chart[s[0]].series[1].name,value:t.chart[s[0]].finished})]})]}),e.jsx("div",{children:e.jsx(ae,{series:t.chart[s[0]].series,xAxis:t.chart[s[0]].range,type:"bar",customOptions:{colors:[k[0],k[2]],legend:{show:!1}}})})]}),e.jsx(A,{loading:d,type:"cover",children:d&&e.jsx("div",{className:"h-[300px]"})})]})},le=({range:t,onDownload:a})=>{const s=t==="monthly"?"Monthly Report":"Yearly Report",n=t==="monthly"?"bg-blue-50":"bg-yellow-50",d=t==="monthly"?"bg-blue-600 hover:bg-blue-700":"bg-yellow-500 hover:bg-yellow-600";return e.jsx(U.div,{className:"mb-4 transition-all duration-500 ease-in-out",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(v,{className:`${n} transition-colors duration-300`,bordered:!0,children:e.jsxs("div",{className:"grid gap-x-4 grid-cols-12",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-6 flex items-center gap-2",children:[e.jsx(R,{className:"text-2xl text-gray-700"}),e.jsx("h6",{className:"font-bold capitalize text-gray-800",children:s})]}),e.jsx("div",{className:"col-span-12 sm:col-span-6 flex items-center justify-end",children:e.jsxs("button",{className:`text-white px-4 py-2 rounded ${d} transition duration-300 flex items-center gap-2`,onClick:()=>a(t),children:[e.jsx(R,{className:"text-lg"}),"Download"]})})]})})},t)},M=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],re=()=>{const t=new Date().getFullYear();return Array.from({length:10},(a,s)=>({value:t-s,label:(t-s).toString()}))},oe=({data:t=[]})=>{const[a,s]=m.useState(["monthly"]),[n,d]=m.useState(new Date().getMonth()+1),[i,o]=m.useState(new Date().getFullYear()),c=l=>{console.log("Selected month label:",l)},b=()=>{d(new Date().getMonth()+1),o(new Date().getFullYear())},f=async l=>{try{let p;l==="monthly"?p=await q({year:i,month:n}):p=await Q({year:i});const u=new Blob([p.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),x=window.URL.createObjectURL(u),r=document.createElement("a");r.href=x,r.download=l==="monthly"?`monthly_report_${i}_${n}.xlsx`:`yearly_report_${i}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r),console.log("Report downloaded successfully")}catch(p){console.error("Download failed:",p)}};return e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 flex-wrap gap-4",children:[e.jsxs("h4",{children:[a[0]==="monthly"?"Monthly":"Yearly"," Reports"]}),e.jsxs(h,{value:a,size:"sm",onChange:l=>s(l),children:[e.jsx(h.Item,{value:"monthly",children:"Monthly"}),e.jsx(h.Item,{value:"yearly",children:"Yearly"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[a[0]==="monthly"&&e.jsx("select",{className:"p-2 border rounded-md dark:bg-gray-800 dark:border-gray-700",value:n,onChange:l=>{var x;const p=Number(l.target.value),u=((x=M.find(r=>r.value===p))==null?void 0:x.label)||"";d(p),c(u)},children:M.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),e.jsx("select",{className:"p-2 border rounded-md dark:bg-gray-800 dark:border-gray-700",value:i,onChange:l=>o(Number(l.target.value)),children:re().map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),e.jsx("button",{onClick:b,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:"Reset filters",children:e.jsx(H,{size:18})})]})]}),e.jsx(le,{range:a[0],onDownload:f})]})};F("projectDashboard",Z);let y=JSON.parse(localStorage.getItem("user")||"{}");console.log(y,"user");const ne={dashboardData:{userName:(y==null?void 0:y.name)||"user",taskCount:12,projectOverviewData:{chart:{weekly:{onGoing:34,finished:18,total:52,series:[{name:"Ongoing",data:[12,8,15,10,7,9,14]},{name:"Finished",data:[4,2,5,3,6,7,5]}],range:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},monthly:{onGoing:125,finished:75,total:200,series:[{name:"Ongoing",data:[30,25,35,40,30,20,25]},{name:"Finished",data:[15,10,20,25,15,10,15]}],range:["Week 1","Week 2","Week 3","Week 4","Week 5","Week 6","Week 7"]},daily:{onGoing:8,finished:4,total:12,series:[{name:"Ongoing",data:[3,5,2,4,6,3,5]},{name:"Finished",data:[1,2,1,3,2,1,2]}],range:["9AM","10AM","11AM","12PM","1PM","2PM","3PM"]}}},projectsData:[{id:"1",name:"Website Redesign",category:"Web Development",desc:"Complete redesign of company website",attachmentCount:12,totalTask:45,completedTask:28,progression:62,dayleft:14,status:"in progress",member:[{id:"1",name:"John Doe",email:"john@example.com",img:"/img/avatars/thumb-1.jpg"},{id:"2",name:"Jane Smith",email:"jane@example.com",img:"/img/avatars/thumb-2.jpg"}]},{id:"2",name:"Mobile App",category:"Mobile Development",desc:"Development of company mobile application",attachmentCount:8,totalTask:32,completedTask:12,progression:38,dayleft:21,status:"in progress",member:[{id:"3",name:"Robert Johnson",email:"robert@example.com",img:"/img/avatars/thumb-3.jpg"},{id:"4",name:"Emily Davis",email:"emily@example.com",img:"/img/avatars/thumb-4.jpg"}]}]}},et=()=>{Y();const t=ne.dashboardData,a=!1;return m.useEffect(()=>{},[]),e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs(A,{loading:a,children:[e.jsx(te,{userName:t==null?void 0:t.userName,taskCount:t==null?void 0:t.taskCount}),e.jsx("div",{className:"flex flex-col xl:flex-row gap-4",children:e.jsxs("div",{className:"flex flex-col gap-4 flex-auto",children:[e.jsx(oe,{data:t==null?void 0:t.projectsData}),e.jsx(se,{data:t==null?void 0:t.projectOverviewData})]})})]})})};export{et as default};
